var w=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var O=w((S,h)=>{(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(i){if(i.ep)return;i.ep=!0;const n=t(i);fetch(i.href,n)}})();function y(r,e,t,s=15){const i=r[e][t];if(!i)return{isWin:!1,winner:null,winningCells:[]};const n=[{dr:0,dc:1},{dr:1,dc:0},{dr:1,dc:1},{dr:1,dc:-1}];for(const o of n){const c=p(r,e,t,o.dr,o.dc,s);if(c.isWin)return{isWin:!0,winner:i,winningCells:c.cells}}return{isWin:!1,winner:null,winningCells:[]}}function p(r,e,t,s,i,n){const o=r[e][t],c=[[e,t]];let a=e+s,l=t+i;for(;a>=0&&a<n&&l>=0&&l<n&&r[a][l]===o;)c.push([a,l]),a+=s,l+=i;for(a=e-s,l=t-i;a>=0&&a<n&&l>=0&&l<n&&r[a][l]===o;)c.unshift([a,l]),a-=s,l-=i;const u=c.length>=5,C=u?c.slice(0,5):[];return{isWin:u,cells:C}}function b(r,e=15){for(let t=0;t<e;t++)for(let s=0;s<e;s++)if(r[t][s]===null)return!1;return!0}function v(r,e,t,s=15){const i=y(r,e,t,s);if(i.isWin)return{isGameOver:!0,isWin:!0,isDraw:!1,winner:i.winner,winningCells:i.winningCells};const n=b(r,s);return{isGameOver:n,isWin:!1,isDraw:n,winner:null,winningCells:[]}}function d(r=15,e=15){if(r>e*e)throw new Error(`Nelze vygenerovat ${r} překážek na mřížce ${e}×${e}`);const t=new Set;for(;t.size<r;){const s=Math.floor(Math.random()*e),i=Math.floor(Math.random()*e),n=`${s},${i}`;t.add(n)}return Array.from(t).map(s=>{const[i,n]=s.split(",").map(Number);return[i,n]})}function M(r){return new Set(r.map(([e,t])=>`${e},${t}`))}function k(r,e,t){return t.has(`${r},${e}`)}class g{constructor(e=15){this.size=e,this.currentPlayer="X",this.gameState=this.initializeGameState(),this.moveHistory=[],this.gameOver=!1,this.winner=null,this.isDraw=!1,this.winningCells=[],this.obstacles=[],this.obstaclesSet=new Set}initializeGameState(){return Array.from({length:this.size},()=>Array.from({length:this.size},()=>null))}makeMove(e,t){if(this.gameOver||e<0||e>=this.size||t<0||t>=this.size||k(e,t,this.obstaclesSet)||this.gameState[e][t]!==null)return!1;this.gameState[e][t]=this.currentPlayer,this.moveHistory.push({row:e,col:t,player:this.currentPlayer});const s=v(this.gameState,e,t,this.size);return s.isGameOver?(this.gameOver=!0,s.isWin?(this.winner=s.winner,this.winningCells=s.winningCells):s.isDraw&&(this.isDraw=!0)):this.switchPlayer(),!0}switchPlayer(){this.currentPlayer=this.currentPlayer==="X"?"O":"X"}getCellValue(e,t){return e<0||e>=this.size||t<0||t>=this.size?null:this.gameState[e][t]}isCellOccupied(e,t){return this.getCellValue(e,t)!==null}get moveCount(){let e=0;for(let t=0;t<this.size;t++)for(let s=0;s<this.size;s++)this.gameState[t][s]!==null&&e++;return e}reset(){this.currentPlayer="X",this.gameState=this.initializeGameState(),this.moveHistory=[],this.gameOver=!1,this.winner=null,this.isDraw=!1,this.winningCells=[]}setObstacles(e){this.obstacles=e,this.obstaclesSet=M(e)}clearObstacles(){this.obstacles=[],this.obstaclesSet=new Set}getCurrentPlayer(){return this.currentPlayer}getGameState(){return this.gameState}}class f{constructor(e){this.game=e,this.gridContainer=document.getElementById("gridContainer"),this.currentPlayerElement=document.getElementById("currentPlayer"),this.resetButton=document.getElementById("resetButton"),this.gameResultModal=document.getElementById("gameResultModal"),this.gameResultMessage=document.getElementById("gameResultMessage"),this.modalCloseButton=document.getElementById("modalCloseButton"),this.obstaclesCheckbox=document.getElementById("obstaclesCheckbox"),this.init()}init(){this.restoreObstaclesFromCookie(),this.renderGrid(),this.attachEventListeners(),this.updateTurnIndicator()}restoreObstaclesFromCookie(){if(!this.obstaclesCheckbox)return;if(this.getCookie("obstaclesEnabled")==="true"){this.obstaclesCheckbox.checked=!0;const t=d(15,this.game.size);this.game.setObstacles(t)}}getCookie(e){const t=e+"=",s=document.cookie.split(";");for(let i of s)if(i=i.trim(),i.indexOf(t)===0)return i.substring(t.length);return null}setCookie(e,t,s=365){const i=new Date;i.setTime(i.getTime()+s*24*60*60*1e3);const n="expires="+i.toUTCString();document.cookie=e+"="+t+";"+n+";path=/"}renderGrid(){this.gridContainer.innerHTML="";for(let e=0;e<this.game.size;e++)for(let t=0;t<this.game.size;t++){const s=document.createElement("div");if(s.className="cell",s.dataset.row=e,s.dataset.col=t,this.game.obstacles&&this.game.obstacles.some(([i,n])=>i===e&&n===t))s.classList.add("obstacle"),s.classList.add("occupied");else{const i=this.game.getCellValue(e,t);i&&(s.textContent=i,s.dataset.value=i,s.classList.add("occupied"))}this.gridContainer.appendChild(s)}}attachEventListeners(){this.gridContainer.addEventListener("click",e=>{e.target.classList.contains("cell")&&this.handleCellClick(e.target)}),this.obstaclesCheckbox&&this.obstaclesCheckbox.addEventListener("change",e=>{this.setCookie("obstaclesEnabled",e.target.checked?"true":"false")}),this.resetButton.addEventListener("click",()=>{this.handleReset()}),this.modalCloseButton&&this.modalCloseButton.addEventListener("click",()=>{this.hideModal()}),this.gameResultModal&&this.gameResultModal.addEventListener("click",e=>{e.target===this.gameResultModal&&this.hideModal()})}handleCellClick(e){const t=parseInt(e.dataset.row),s=parseInt(e.dataset.col);this.game.makeMove(t,s)&&(this.updateCell(e,t,s),this.updateTurnIndicator(),this.game.gameOver&&(this.game.winner?(this.highlightWinningCells(),this.showWinnerModal(this.game.winner)):this.game.isDraw&&this.showDrawModal()))}updateCell(e,t,s){const i=this.game.getCellValue(t,s);i&&(e.textContent=i,e.dataset.value=i,e.classList.add("occupied"))}updateTurnIndicator(){const e=this.game.getCurrentPlayer();this.currentPlayerElement.textContent=e,this.currentPlayerElement.classList.remove("player-x","player-o"),e==="X"?this.currentPlayerElement.classList.add("player-x"):e==="O"&&this.currentPlayerElement.classList.add("player-o")}handleReset(){if(this.game.reset(),this.obstaclesCheckbox&&this.obstaclesCheckbox.checked){const e=d(15,this.game.size);this.game.setObstacles(e)}else this.game.clearObstacles();this.renderGrid(),this.updateTurnIndicator(),this.hideModal()}highlightWinningCells(){!this.game.winningCells||this.game.winningCells.length===0||this.game.winningCells.forEach(([e,t])=>{const s=this.gridContainer.querySelector(`[data-row="${e}"][data-col="${t}"]`);s&&s.classList.add("winning-cell")})}showWinnerModal(e){!this.gameResultModal||!this.gameResultMessage||(this.gameResultMessage.textContent=`Vítěz: ${e}`,this.gameResultModal.classList.add("visible"))}showDrawModal(){!this.gameResultModal||!this.gameResultMessage||(this.gameResultMessage.textContent="Remíza",this.gameResultModal.classList.add("visible"))}hideModal(){this.gameResultModal&&this.gameResultModal.classList.remove("visible")}}let m;typeof document<"u"&&document.addEventListener("DOMContentLoaded",()=>{m=new g(15),new f(m)});typeof h<"u"&&h.exports&&(h.exports={TicTacToeGame:g,GameUI:f})});export default O();
