# Story 1.4: Re≈æim s p≈ôek√°≈ækami (Obstacles Mode)

## Story ID
1.4

## Title
Re≈æim s p≈ôek√°≈ækami - n√°hodn√© zaminov√°n√≠ pol√≠

## Epic
1

## Status
Draft

## Description
Implementace p≈ôek√°≈ækov√©ho re≈æimu, kter√Ω obohacuje hru:
- Checkbox "P≈ôek√°≈æky" vedle tlaƒç√≠tka "Nov√° hra"
- Kdy≈æ je aktivn√≠, "Nov√° hra" n√°hodnƒõ zaminuje 15 pol√≠
- Zaminovan√° pole se zobrazuj√≠ jako ƒçern√° plocha s b√≠lou ikonou bomby
- Na zaminovan√° pole se ned√° hr√°t (jsou blokovan√°)
- Checkbox z≈Øst√°v√° ve zvolen√©m stavu (persistuje p≈ôes v√≠ce her)

## Functional Requirements Covered
- FR8: Mo≈ænost aktivace p≈ôek√°≈ækov√©ho re≈æimu (nov√° feature)
- FR9: N√°hodn√© zaminov√°n√≠ pol√≠ zvy≈°uje obt√≠≈ænost hry

## Acceptance Criteria

- AC4.1: Checkbox "P≈ôek√°≈æky" se zobrazuje vedle "Nov√° hra" v headeru
- AC4.2: Checkbox je vycentrov√°n vertik√°lnƒõ se zbytkem headeru
- AC4.3: Kdy≈æ je checkbox unchecked (OFF), hra bƒõ≈æ√≠ norm√°lnƒõ (bez p≈ôek√°≈æek)
- AC4.4: Kdy≈æ je checkbox checked (ON) a klikne se "Nov√° hra", n√°hodnƒõ se zaminuje p≈ôesnƒõ 15 pol√≠
- AC4.5: Zaminovan√° pole se zobrazuj√≠ jako ƒçern√° plocha (#000) s b√≠lou ikonou bomby (üî• nebo ‚úó)
- AC4.6: Na zaminovan√° pole se ned√° hr√°t (jsou zablokovan√°)
- AC4.7: Zaminovan√° pole nejsou klikateln√° ani p≈ôi "obsazen√≠" (maj√≠ cursor: not-allowed)
- AC4.8: Checkbox z≈Øst√°v√° za≈°krtnut√Ω i po resetu (nov√© h≈ôe)
- AC4.9: V√Ωhra/rem√≠za funguje norm√°lnƒõ i s p≈ôek√°≈ækami

## File List

### New Files
- `src/obstacles.js` - Logika pro zaminov√°n√≠ a generov√°n√≠ p≈ôek√°≈æek

### Modified Files
- `src/index.html` - P≈ôid√°n√≠ checkboxu "P≈ôek√°≈æky"
- `src/styles.css` - Styling pro zaminovan√° pole a checkbox
- `src/game.js` - Integrace obstacles logiky, handleReset()

### Test Files
- `src/obstacles.test.js` - Unit testy pro zaminov√°n√≠
- `src/game.integration.test.js` - Integration testy s p≈ôek√°≈ækami

## Test Plan

### Unit Tests (src/obstacles.test.js)
- Test: Funkce generateRandomObstacles() vr√°t√≠ p≈ôesnƒõ 15 unik√°tn√≠ch pozic
- Test: Vygenerovan√© pozice jsou v rozmez√≠ 0-14
- Test: ≈Ω√°dn√© duplik√°ty v generovan√Ωch pozic√≠ch
- Test: Dvƒõ vygenerov√°n√≠ daj√≠ r≈Øzn√© pozice (randomness)
- Test: Pozn√°mka - zkontrolovat, ≈æe 15 < 225 (mo≈æn√© generovat)

### Integration Tests (src/game.integration.test.js)
- Test: Bez checkboxu se p≈ôek√°≈æky negeneruj√≠
- Test: S checkboxem se po "Nov√© h≈ôe" zaminuje p≈ôesnƒõ 15 pol√≠
- Test: Zaminovan√° pole maj√≠ CSS class `.obstacle` a `.blocked`
- Test: Kliknut√≠ na zaminovan√© pole se ignoruje (≈æ√°dn√Ω efekt)
- Test: Kliknut√≠ na norm√°ln√≠ pole vedle zaminovan√©ho funguje
- Test: Reset hry s checkboxem "on" vygeneruje nov√© p≈ôek√°≈æky
- Test: Reset hry s checkboxem "off" odstran√≠ p≈ôek√°≈æky
- Test: Checkpoint z≈Øst√°v√° za≈°krtnut√Ω po resetu
- Test: V√Ωhra funguje i s p≈ôek√°≈ækami (nap≈ô. 5 v ≈ôadƒõ mimo p≈ôek√°≈æky)

### Manual Testing
- [ ] Checkbox "P≈ôek√°≈æky" je vidƒõt a klikateln√Ω
- [ ] Bez checkboxu - hra bƒõ≈æ√≠ norm√°lnƒõ
- [ ] S checkboxem ON, "Nov√° hra" - zaminuje 15 pol√≠
- [ ] Zaminovan√° pole maj√≠ ƒçernou barvu a b√≠lou ikonu
- [ ] Kliknut√≠ na zaminovan√© pole nem√° efekt
- [ ] Kliknut√≠ na norm√°ln√≠ pole vedle –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è funguje
- [ ] V√Ωhra s p≈ôek√°≈ækami - mod√°ln√≠ okno se zobraz√≠
- [ ] Checkbox z≈Øst√°v√° zapnut√Ω po resetu
- [ ] Test na mobilu - checkbox a zaminovan√° pole jsou vidƒõt

## Risk Assessment

**Risk 1:** N√°hodn√© zaminov√°n√≠ m≈Ø≈æe zablokovat v≈°echny cesty k v√Ωh≈ôe
- Mitigation: Matematicky nejm√©nƒõ 210 voln√Ωch pol√≠ (225 - 15), co≈æ je dost

**Risk 2:** Performance - generov√°n√≠ 15 n√°hodn√Ωch pozic m≈Ø≈æe b√Ωt pomal√©
- Mitigation: Pou≈æ√≠t Set pro kontrolu duplicit (O(1) lookup)

**Risk 3:** CSS konflikty se st√°vaj√≠c√≠m stylingem
- Mitigation: Specifick√© CSS t≈ô√≠dy `.obstacle` a `.blocked`

## Technical Notes

### Obstacles Generation Algorithm
```javascript
function generateRandomObstacles(count = 15, size = 15) {
  const positions = new Set();
  while (positions.size < count) {
    const row = Math.floor(Math.random() * size);
    const col = Math.floor(Math.random() * size);
    positions.add(`${row},${col}`);
  }
  return Array.from(positions).map(pos => {
    const [row, col] = pos.split(',').map(Number);
    return [row, col];
  });
}
```

### UI Implementation
- Checkbox vedle "Nov√° hra" button
- Checkbox label: "P≈ôek√°≈æky"
- CSS class `.obstacle` na zaminovan√° pole
- Barva: #000 (ƒçern√°) s b√≠lou ikonou (‚úó nebo Unicode üí£)

### Game State Extension
- P≈ôidat `obstacles: []` do TicTacToeGame state
- P≈ôidat `obstaclesEnabled: boolean` do GameUI state
- P≈ôi renderGrid() kontrolovat, zda je pole v obstacles[]

## Definition of Done

- [ ] Funkce generateRandomObstacles() implementovan√°
- [ ] Checkbox v UI p≈ôid√°n a funkƒçn√≠
- [ ] Zaminovan√° pole se renderuj√≠ spr√°vnƒõ
- [ ] Blokov√°n√≠ klik√°n√≠ na zaminovan√° pole
- [ ] Unit testy (obstacles.test.js) projdou
- [ ] Integration testy roz≈°√≠≈ôeny
- [ ] Manual testing completed na v≈°ech za≈ô√≠zen√≠ch
- [ ] CSS styling je konzistentn√≠
- [ ] Kontrola edge cases (nap≈ô. v√Ωhra s p≈ôek√°≈ækami)

## Comments

Skvƒõl√° feature pro zv√Ω≈°en√≠ obt√≠≈ænosti! Po tomto story bude MVP hrou s voliteln√Ωm m√≥dem.
Pozdƒõji m≈Ø≈æeme p≈ôidat: poƒç√≠tadlo p≈ôek√°≈æek, √∫rovnƒõ obt√≠≈ænosti, nebo dynamick√© zaminov√°n√≠ bƒõhem hry.

## Next Steps
Po dokonƒçen√≠ Story 1.4:
- Epic 1 (MVP) by mƒõl b√Ωt kompletn√≠ s z√°kladn√≠ hrou + p≈ôek√°≈æky
- Mo≈æn√© Story v Epic 2: AI opponent, multiplayer, persistence, statistiky
