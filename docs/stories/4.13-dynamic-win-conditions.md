# Story 4.13: Dynamic Win Conditions

## Epic
Epic 4: Design & UI Refresh

## User Story

Jako developer
Chci, aby podmínky výhry byly dynamické podle velikosti hry
Abych mohl splnit různé herní pravidla (3 v řadě pro 3×3, 5 v řadě pro ostatní)

## Description

Oprava win detektoru tak, aby používal dynamický `winningLength` místo hardcoded 5.

### Win Conditions
- 3×3: 3 v řadě = výhra
- 10×10: 5 v řadě = výhra
- 15×15: 5 v řadě = výhra

## Acceptance Criteria

1. **AC1:** `checkWin()` přijme `winningLength` parametr
2. **AC2:** `checkDirection()` používá `winningLength` místo hardcoded 5
3. **AC3:** `checkGameState()` přijme `winningLength` parametr
4. **AC4:** `game.makeMove()` předá `this.winningLength` do checkGameState
5. **AC5:** 3×3 detekuje výhru na 3 v řadě (nikoli 4)
6. **AC6:** 10×10 a 15×15 detekují výhru na 5 v řadě
7. **AC7:** Všechny testy procházejí (včetně 14 nových testů)

## Files Changed

### Modified Files
- `src/win-detector.js` - Přidán `winningLength` parametr do checkWin, checkDirection, checkGameState
- `src/game.js` - Předání `this.winningLength` do checkGameState v makeMove
- `src/win-detector.test.js` - Přidáno 14 nových testů

## Technical Notes

### Changed Functions

```javascript
// Before
function checkWin(gameState, lastRow, lastCol, size = 15)
function checkDirection(gameState, row, col, dr, dc, size)
export function checkGameState(gameState, lastRow, lastCol, size = 15)

// After
export function checkWin(gameState, lastRow, lastCol, size = 15, winningLength = 5)
function checkDirection(gameState, row, col, dr, dc, size, winningLength = 5)
export function checkGameState(gameState, lastRow, lastCol, size = 15, winningLength = 5)
```

### Logic Update in checkDirection

```javascript
// Before
const isWin = cells.length >= 5;
const winningCells = isWin ? cells.slice(0, 5) : [];

// After
const isWin = cells.length >= winningLength;
const winningCells = isWin ? cells.slice(0, winningLength) : [];
```

### Game.js Call

```javascript
// In makeMove() method
const gameStateResult = checkGameState(this.gameState, row, col, this.size, this.winningLength);
```

## Test Coverage

New tests added:
- 3×3 board with winningLength=3
  - Horizontal win detection (3 in a row)
  - Vertical win detection (3 in a row)
  - Diagonal win detection (3 in a row)
  - No win on 2 in a row

- 10×10 board with winningLength=5
  - Horizontal win detection (5 in a row)
  - Vertical win detection (5 in a row)
  - No win on 4 in a row

- 15×15 board with winningLength=5
  - Diagonal win detection (5 in a row)
  - No win on 4 in a row
  - Complete checkGameState test

- Mixed conditions tests
  - Different winning lengths affect win detection correctly

## Priority
High

## Effort
M (45-60 minutes)

## Status
✅ Complete - 133/133 tests passing, build successful
