# Story 4.15: Controls Hidden by Default

## Epic
Epic 4: Design & UI Refresh

## User Story

Jako uživatel
Chci, aby nastavení bylo defaultně skryté a pamatovalo si můj stav
Abych měl čistší pohled na hru a nemusel opakovaně otevírat menu

## Description

Nastavení (`.controls-fieldset`) je defaultně skryté s `max-height: 0` a `opacity: 0`. Stav (otevřeno/zavřeno) se ukládá do `localStorage` pod klíčem `settingsMenuOpen`. Nadpis "Nastavení" (`.controls-legend`) je odstraněn (není potřeba).

## Acceptance Criteria

1. **AC1:** `.controls-fieldset` je defaultně skrytý (bez třídy `.open`)
2. **AC2:** `.controls-legend` je odstraněn z HTML (není potřeba)
3. **AC3:** Stav menu se ukládá do `localStorage` pod klíčem `settingsMenuOpen`
4. **AC4:** Při načtení stránky se obnoví stav z localStorage (default: zavřeno)
5. **AC5:** Po resetu hry zůstává menu v aktuálním stavu (netřeba zavírat)
6. **AC6:** Na mobilu stejné chování - defaultně zavřeno
7. **AC7:** Všechny testy procházejí (včetně 6 nových)

## Files Changed

### Modified Files
- `src/index.html` - Odebrat `<div class="controls-legend">` element
- `src/styles.css` - Upravit `.controls-fieldset` styling (hidden by default), `.controls-legend` na `display: none`
- `src/game.js` - localStorage read/write v `restoreMenuState()` a `toggleSettings()`
- `src/game.integration.test.js` - 6 nových testů

## Technical Notes

### HTML Changes
```html
<!-- BEFORE: -->
<div class="controls-fieldset">
    <div class="controls-legend">Nastavení</div>
    <div class="controls">
        ...
    </div>
</div>

<!-- AFTER: -->
<div class="controls-fieldset">
    <div class="controls">
        ...
    </div>
</div>
```

### CSS Changes
```css
.controls-fieldset {
    border: 1px solid #ddd;
    border-radius: 0.5rem;
    padding: 0;
    background: white;
    max-height: 0;           /* Hidden by default */
    overflow: hidden;
    opacity: 0;
    transition: max-height 0.3s ease-out, opacity 0.3s ease-out, padding 0.3s ease-out;
}

.controls-fieldset.open {
    max-height: 300px;       /* Otevřené */
    opacity: 1;
    padding: 1rem;
}

.controls-legend {
    display: none;           /* Odstraněn z zobrazení */
}
```

### JavaScript localStorage Methods
```javascript
// Obnovit stav z localStorage
restoreMenuState() {
    if (!this.hamburgerButton || !this.controlsFieldset) return;

    const isOpen = localStorage.getItem('settingsMenuOpen') === 'true';
    if (isOpen) {
        this.controlsFieldset.classList.add('open');
        this.hamburgerButton.setAttribute('aria-expanded', 'true');
        this.hamburgerButton.textContent = '×';
    }
}

// Uložit stav do localStorage
toggleSettings() {
    ...
    localStorage.setItem('settingsMenuOpen', isOpen ? 'true' : 'false');
    ...
}
```

## Test Cases

6 nových testů:
1. Stav se ukládá do localStorage při otevření (true)
2. Stav se ukládá do localStorage při zavření (false)
3. Při načtení bez localStorage je menu zavřené
4. Při načtení s localStorage=true je menu otevřené a ikona je ×
5. Nadpis "Nastavení" (.controls-legend) neexistuje v DOM
6. Reset hry nemění stav menu (zůstane otevřené pokud bylo otevřené)

## Priority
Medium

## Effort
S (30-45 minutes)

## Status
✅ Complete - 147/147 tests passing, build successful
