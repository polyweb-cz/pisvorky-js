# Story 4.9: Game Size Select

## Epic
Epic 4: Design & UI Refresh

## User Story

Jako hráč
Chci si vybrat velikost herní plochy (3×3, 10×10, 15×15)
Abych si mohl hrát různě dlouhé partie s různou obtížností

## Description

Přidat nový select do fieldset pro výběr velikosti hry. Každá velikost má:
- Jinou mřížku (3×3, 10×10, 15×15)
- Jinou podmínku na výhru (počet vytěžných v řadě)
- Jiný počet bomb (podle obtížnosti)

### Varianty her

| Velikost | Grid | Vytěžné | Bomb | Čas | Obtížnost |
|----------|------|---------|------|-----|-----------|
| **3×3**  | 3×3  | 3       | 1    | 1-2 min | Snadná |
| **10×10** | 10×10 | 5      | 10   | 5-10 min | Střední |
| **15×15** | 15×15 | 5      | 15   | 10-20 min | Těžká *(DEFAULT)* |

## Tasks

- [ ] Vytvořit story dokument
- [ ] Upravit HTML - přidat size select do fieldset
- [ ] Upravit CSS - CSS Grid responsive dle velikosti
- [ ] Upravit JS - TicTacToeGame konstruktor na dynamic size
- [ ] Upravit JS - URL hash s `size` parametrem
- [ ] Přidat testy pro kombinace (3×3, 10×10, 15×15) × (s/bez bomb)
- [ ] Testovat všechny kombinace

## Acceptance Criteria

1. **AC1:** Select má tři volby: 3×3, 10×10, 15×15
2. **AC2:** Default je 15×15
3. **AC3:** Každá velikost má správný počet vytěžných (3, 5, 5)
4. **AC4:** Počet bomb je správný (1, 10, 15)
5. **AC5:** Grid se dynamicky změnit (CSS grid-template-columns)
6. **AC6:** URL hash uloží size: `#size=10&obstacles=yes`
7. **AC7:** Při načtení se obnoví size a obstacles z URL
8. **AC8:** Všechny kombinace (3 velikosti × 2 obstacles) fungují
9. **AC9:** Testy procházejí (115+ testů)
10. **AC10:** Build je úspěšný

## Test Plan

### Visual Testing
- [ ] 3×3 bez bomb - malá mřížka, 1 bomba
- [ ] 3×3 s bombami - bomba v mřížce
- [ ] 10×10 bez bomb - střední mřížka, 10 bomb
- [ ] 10×10 s bombami - správné počty
- [ ] 15×15 bez bomb - velká mřížka (default)
- [ ] 15×15 s bombami - default s bombami
- [ ] Změna size - grid se změní, game se zresetuje
- [ ] URL hash - lze změnit URL a obnovit nastavení

### Automated Testing
- [ ] Test: 3×3 vytvoří mřížku 3×3 (9 buněk)
- [ ] Test: 10×10 vytvoří mřížku 10×10 (100 buněk)
- [ ] Test: 15×15 vytvoří mřížku 15×15 (225 buněk)
- [ ] Test: Počet bomb je správný (1, 10, 15)
- [ ] Test: URL hash se změní při výběru
- [ ] Test: Obnovení z URL hash funguje
- [ ] Všechny testy procházejí

## Files Changed

### Modified Files
- `src/index.html` - Přidat size select do fieldset
- `src/styles.css` - CSS Grid responsive (grid-template-columns)
- `src/game.js` - Constructor s `size`, URL hash `size` param
- `src/game.integration.test.js` - Testy pro všechny kombinace

## Technical Notes

### HTML Changes
```html
<div class="controls-fieldset">
  <div class="controls-legend">Nastavení</div>
  <div class="controls">
    <!-- NEW -->
    <div class="game-size-select-group">
      <label for="gameSizeSelect">Velikost:</label>
      <select id="gameSizeSelect">
        <option value="3">3×3 (Snadné)</option>
        <option value="10">10×10 (Střední)</option>
        <option value="15" selected>15×15 (Těžké)</option>
      </select>
    </div>

    <div class="obstacle-select-group">
      <label for="obstaclesSelect">Překážky:</label>
      <select id="obstaclesSelect">...</select>
    </div>
    <button class="reset-button">Nová hra</button>
  </div>
</div>
```

### CSS Changes
```css
/* Game size responsive */
.grid-container {
  display: grid;
  gap: 2px;
  background: #ddd;
  border: 2px solid #999;
  border-radius: 0.5rem;
  padding: 2px;
  width: 100%;
  max-width: 600px;
  aspect-ratio: 1 / 1;
  /* grid-template-columns se nastaví via CSS Custom Properties nebo JS */
}

/* Size-specific grids */
.grid-container.size-3 {
  grid-template-columns: repeat(3, 1fr);
}

.grid-container.size-10 {
  grid-template-columns: repeat(10, 1fr);
}

.grid-container.size-15 {
  grid-template-columns: repeat(15, 1fr);
}
```

### JavaScript Changes
```javascript
class TicTacToeGame {
    constructor(size = 15) {
        this.size = size;
        this.winningLength = size === 3 ? 3 : 5; // 3×3 = 3, jinak 5
        this.bombCount = size === 3 ? 1 : (size === 10 ? 10 : 15);
        // ... rest
    }
}

// URL Hash s size
getGameStateFromHash() {
  const hash = window.location.hash.slice(1);
  const params = new URLSearchParams(hash);
  return {
    size: parseInt(params.get('size')) || 15, // Default 15
    obstacles: params.get('obstacles') === 'yes'
  };
}

setGameStateHash(size, obstacles) {
  const hash = `size=${size}&obstacles=${obstacles ? 'yes' : 'no'}`;
  window.location.hash = hash;
}
```

## Risk Assessment

**Risk 1:** Změna konstruktoru může prověřit existující testy
- **Mitigation:** Přidat testy pro nové parametry

**Risk 2:** CSS grid-template-columns nemusí fungovat dynamicky
- **Mitigation:** Používat CSS třídy `.size-3`, `.size-10`, `.size-15`

**Risk 3:** 3×3 hra je příliš snadná/krátká
- **Mitigation:** UI varovná zpráva nebo adjust podmínek

## Definition of Done

- [ ] Story dokument napsán
- [ ] HTML s size select přidán
- [ ] CSS pro tři velikosti implementován
- [ ] JS konstruktor a URL hash upraveny
- [ ] Testy pro všechny kombinace přidány
- [ ] Všechny testy procházejí (115+) ✓
- [ ] Build úspěšný ✓
- [ ] Visual testing na všech velikostech ✓
- [ ] Commit vytvořen

## Status

Draft → In Progress → Completed

---

**Created:** 2025-11-02
**Epic:** 4 - Design & UI Refresh
**Priority:** High
**Effort:** M (45-60 minutes)
**Depends on:** 4.4, 4.5 ✓
**Follow-up:** AI opponent hra?

## Implementation Complexity

### Constructor Changes
```javascript
// OLD
class TicTacToeGame {
    constructor() {
        this.size = 15;
        this.winningLength = 5;
    }
}

// NEW
class TicTacToeGame {
    constructor(size = 15) {
        this.size = size; // 3, 10, nebo 15
        this.winningLength = size === 3 ? 3 : 5; // Specifický na velikost
        this.bombCount = size === 3 ? 1 : (size === 10 ? 10 : 15); // Specifický
    }
}
```

### URL Hash Examples
- `https://game.com/#size=3` - 3×3 bez bomb (default)
- `https://game.com/#size=10&obstacles=yes` - 10×10 s bombami
- `https://game.com/#size=15&obstacles=no` - 15×15 bez bomb (default combo)

Výhoda: Hráč si může vytvořit favorit odkaz s jeho oblíbeným nastavením!
